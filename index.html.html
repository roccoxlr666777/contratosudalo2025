<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>Sistema Integral de Gesti√≥n de Talento UDAL</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
    
    <style>
        :root {
            --primary: #00205B;
            --secondary: #A32429;
            --accent: #BFA65A;
            --bg: #f8f9fa;
            --text: #333;
        }
        
        * { box-sizing: border-box; }
        
        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: var(--bg);
            margin: 0;
            padding: 0;
            color: var(--text);
            overflow-x: hidden;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            box-shadow: 0 4px 25px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 100;
            background: white;
        }
        
        /* Header APP */
        header {
            background: linear-gradient(135deg, var(--primary) 0%, #00153d 100%);
            color: white;
            padding: 20px;
            text-align: center;
            border-bottom: 4px solid var(--accent);
        }
        header h1 { margin: 0; font-size: 1.2rem; text-transform: uppercase; letter-spacing: 1px; font-weight: 700; }
        header p { margin: 5px 0 0; font-size: 0.8rem; opacity: 0.9; color: var(--accent); }

        /* Vistas */
        .view { display: none; padding: 20px; flex-grow: 1; }
        .view.active { display: block; animation: fadeIn 0.4s ease-out; }

        /* Buscador */
        .search-container { position: sticky; top: 0; background: white; padding-bottom: 15px; z-index: 30; border-bottom: 1px solid #eee; }
        input[type="text"] { width: 100%; padding: 14px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; transition: 0.3s; background: #fafafa; }
        input[type="text"]:focus { border-color: var(--primary); outline: none; background: white; }
        
        .teacher-list { max-height: 55vh; overflow-y: auto; margin-top: 10px; }
        .teacher-item { padding: 15px; border-bottom: 1px solid #eee; cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: 0.2s; background: white; }
        .teacher-item:hover { background: #f0f4ff; padding-left: 20px; }
        .teacher-item strong { color: var(--primary); font-size: 0.95rem; }

        /* Formulario */
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 6px; font-weight: 600; color: var(--primary); font-size: 0.85rem; }
        input.form-control { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; font-size: 0.95rem; }
        
        .auth-section {
            background: #e8f0fe;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid var(--primary);
        }

        /* CORRECCI√ìN DE ESTILOS DE FIRMA */
        .signature-container { 
            border: 2px dashed #bbb; 
            border-radius: 8px; 
            background: #fff; 
            position: relative; 
            height: 250px; 
            width: 100%; /* Asegura ancho completo */
            touch-action: none; 
            overflow: hidden; /* Evita desbordes */
        }
        
        canvas { 
            width: 100%; 
            height: 100%; 
            display: block; /* Elimina espacio inferior inline */
        }
        
        .clear-sig { 
            position: absolute; 
            top: 10px; 
            right: 10px; 
            background: #eee; 
            border: 1px solid #ccc; 
            padding: 5px 12px; 
            border-radius: 4px; 
            cursor: pointer; 
            font-weight: bold; 
            font-size: 0.8rem;
            z-index: 10;
        }

        /* Botones */
        .btn { width: 100%; padding: 15px; border: none; border-radius: 8px; font-size: 0.95rem; font-weight: 700; cursor: pointer; text-transform: uppercase; margin-top: 10px; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-whatsapp { background: #25D366; color: white; text-decoration: none; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .btn-secondary { background: white; color: #666; border: 2px solid #ddd; }

        /* ----- ESTILOS DEL CONTRATO ----- */
        #contract-wrapper {
            position: absolute; top: 0; left: 0; z-index: -1; 
            width: 816px; background: white; visibility: hidden; 
        }
        #contract-wrapper.generating { visibility: visible; }

        #contract-template {
            width: 816px; 
            background: white; 
            color: black;
            font-family: 'Times New Roman', serif;
            text-align: justify;
            box-sizing: border-box;
            padding: 0;
        }

        /* PAGINA 1: CONTRATO OFICIO */
        .pdf-page-contract {
            width: 100%;
            height: 1344px; /* Altura Oficio */
            padding: 40px 50px; 
            position: relative;
            page-break-after: always;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* PAGINA 2: ANEXO OFICIO */
        .pdf-page-annex {
            width: 100%;
            height: 1344px;
            padding: 40px 50px;
            position: relative;
            page-break-after: avoid; 
            margin-bottom: 0;
            padding-bottom: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* FUENTE 11px */
        .content-body {
            font-size: 11px; 
            line-height: 1.2; 
        }
        
        p { margin: 0 0 6px 0; text-indent: 0; }
        
        .section-title { 
            font-size: 11px; 
            text-align: center; 
            font-weight: bold; 
            margin: 10px 0; 
            text-transform: uppercase; 
            letter-spacing: 1px;
        }
        
        .contract-table { width: 100%; border-collapse: collapse; margin: 10px 0; font-size: 10px; }
        .contract-table th, .contract-table td { border: 1px solid black; padding: 4px; text-align: center; vertical-align: middle; }
        
        /* Contenedores de Firma */
        .signature-grid { display: flex; justify-content: space-between; margin-top: 25px; text-align: center; width: 100%; font-size: 10px; }
        .sig-box { width: 40%; border-top: 1px solid black; padding-top: 5px; position: relative; }
        
        /* Im√°genes de Firma */
        .signature-fill {
            mix-blend-mode: multiply;
            position: absolute;
            z-index: 2000; 
        }

        /* Firma Principal (420px) */
        .sig-main {
            bottom: 0px; 
            left: 50%;
            transform: translateX(-50%);
            width: 420px; 
        }

        .fill-data { font-weight: bold; text-transform: uppercase; }

        #loader {
            position: fixed; top:0; left:0; width:100%; height:100%;
            background: rgba(0,0,0,0.8); z-index: 9999;
            display: none; justify-content: center; align-items: center; color: white;
            flex-direction: column;
        }
    </style>
</head>
<body>

<div id="loader">
    <div style="font-size: 40px;">‚è≥</div>
    <h3>Generando PDF...</h3>
</div>

<div class="container">
    <header>
        <h1>UDAL | Gesti√≥n de Talento</h1>
        <p>Contrataci√≥n Docente 2025</p>
    </header>

    <div id="view-select" class="view active">
        <div class="search-container">
            <label>Paso 1: Identif√≠cate</label>
            <input type="text" id="search-input" placeholder="Escribe tus apellidos..." onkeyup="filterList()">
        </div>
        <div id="list-container" class="teacher-list"></div>
    </div>

    <div id="view-form" class="view">
        <h3 style="text-align:center; color:var(--primary);">Verifica tus datos</h3>
        <p style="text-align:center; color:#666; margin-bottom:20px;">Docente: <strong id="lbl-name"></strong></p>

        <div class="auth-section">
            <label style="color:#A32429;">üîí Validaci√≥n de Seguridad</label>
            <p style="font-size:0.85rem; margin-bottom:10px;">Ingresa tu matr√≠cula tal como aparece en tu evaluaci√≥n docente para desbloquear el contrato.</p>
            <div style="display:flex; gap:10px;">
                <input type="password" id="inp-matricula" class="form-control" placeholder="Tu Matr√≠cula">
                <button class="btn btn-primary" style="margin:0; width:auto;" onclick="verifyTeacher()">Validar</button>
            </div>
        </div>

        <div id="form-content" style="display:none; opacity:0.5; pointer-events:none;">
            <div class="form-group">
                <label>Domicilio Completo:</label>
                <input type="text" id="inp-address" class="form-control" placeholder="Calle, N√∫mero, Colonia, Ciudad, CP">
            </div>
            <div class="form-group">
                <label>RFC:</label>
                <input type="text" id="inp-rfc" class="form-control" placeholder="AAAA000000XXX" style="text-transform: uppercase;">
            </div>
            <div class="form-group">
                <label>CURP:</label>
                <input type="text" id="inp-curp" class="form-control" placeholder="AAAA000000H..." style="text-transform: uppercase;">
            </div>

            <div class="form-group">
                <label>Tu Firma (Requerida):</label>
                <div class="signature-container">
                    <canvas id="sig-canvas"></canvas>
                    <button class="clear-sig" onclick="handleClearSig()">Limpiar / Corregir Firma</button>
                </div>
                <small style="text-align:center; display:block; color:#888;">Firma dentro del recuadro (Tinta Azul)</small>
            </div>

            <button class="btn btn-primary" id="btn-generate" onclick="generateContract()">Generar Contrato</button>
        </div>
        
        <button class="btn btn-secondary" onclick="showView('view-select')">Regresar</button>
    </div>

    <div id="view-success" class="view" style="text-align:center;">
        <h2 style="color:#25D366; font-size:2rem;">¬°Listo!</h2>
        <p>El contrato se ha descargado a tu dispositivo.</p>
        
        <div style="background:#fff3cd; color:#856404; padding:15px; border-radius:5px; margin:20px 0; text-align:left; font-size:0.9rem;">
            <strong>PASO FINAL OBLIGATORIO:</strong><br>
            1. Presiona el bot√≥n de WhatsApp abajo.<br>
            2. En el chat, presiona el clip (üìé) o signo de m√°s (+).<br>
            3. Selecciona el archivo PDF que se acaba de descargar y env√≠alo.
        </div>
        
        <a id="wa-link" href="#" target="_blank" class="btn btn-whatsapp">
            Enviar por WhatsApp
        </a>
        <button class="btn btn-secondary" onclick="downloadPDF()">Volver a Descargar PDF</button>
    </div>
</div>

<div id="contract-wrapper">
    <div id="contract-template">
        
        <div class="pdf-page-contract">
            
            <div style="text-align: center; font-weight: bold; margin-bottom: 10px; font-size: 11px;">
                CONTRATO DE PRESTACI√ìN DE SERVICIOS PROFESIONALES INDEPENDIENTES POR HONORARIOS
            </div>
            
            <div class="content-body">
                <p>QUE CELEBRAN, POR UNA PARTE, <strong>PROMOTORA DEL ARTE Y LA CULTURA DE PUEBLA, DIVISI√ìN ESTUDIOS SUPERIORES A.C Y/O UDAL UNIVERSIDAD DE AM√âRICA LATINA</strong>, A LA QUE EN LO SUCESIVO SE LE DENOMINAR√Å ‚ÄúLA INSTITUCI√ìN‚Äù, REPRESENTADA EN ESTE ACTO POR EL RECTOR EL <strong>INGENIERO JES√öS L√ìPEZ CHARGOY</strong>; Y POR LA OTRA PARTE, EL/LA C. <span id="c-name" class="fill-data"></span>, A QUIEN EN LO SUCESIVO SE LE DENOMINAR√Å ‚ÄúEL PRESTADOR‚Äù, MISMOS QUE SE SOMETEN AL TENOR DE LAS SIGUIENTES DECLARACIONES Y CL√ÅUSULAS:</p>

                <div class="section-title">D E C L A R A C I O N E S</div>
                
                <p><strong>I. DECLARA ‚ÄúLA INSTITUCI√ìN‚Äù:</strong> Ser una Asociaci√≥n Civil legalmente constituida de acuerdo a las leyes del pa√≠s. Representada en este acto por el <strong>Ingeniero Jes√∫s L√≥pez Chargoy</strong>, persona que se encuentra facultada para celebrar y suscribir el presente contrato de conformidad con el Instrumento Notarial N√∫mero: 35923, Volumen CDXLVIII, de fecha 24 de Mayo de 1996, celebrado ante la fe del Licenciado Jorge Hern√°ndez Madrid, titular de la Notar√≠a P√∫blica N√∫mero 4 de la Ciudad Puebla, Puebla. Su Registro Federal de Contribuyentes es <strong>PAC960524FL3</strong>. Que tiene como fines dedicarse a toda clase de actividades relativas a la educaci√≥n, a la investigaci√≥n cient√≠fica y a la difusi√≥n de la cultura y el deporte. Que para cumplir con sus fines, requiere temporalmente contar con los servicios de una persona f√≠sica con la pericia y conocimientos necesarios, por lo que ha determinado contratar a ‚ÄúEL PRESTADOR‚Äù para llevar a cabo servicios no subordinados regidos por la legislaci√≥n civil. Se√±ala como domicilio legal para efectos de este contrato: El ubicado en 17 Poniente 309, Col. El Carmen, Puebla, Pue., independientemente de que los servicios contratados se presten en dicho domicilio o en planteles ubicados en 6 B Sur 3106, Ladrillera de Ben√≠tez; Calle 3 Sur 4116, Gabriel Pastor 1ra Secc; o Av. 25 Pte 315, H√©roe de Nacozari, en Heroica Puebla de Zaragoza, Pue.</p>

                <p><strong>II. DECLARA ‚ÄúEL PRESTADOR‚Äù:</strong> Ser una persona f√≠sica en pleno ejercicio de sus derechos, con capacidad para celebrar el presente contrato. Contar con los conocimientos t√©cnicos, te√≥ricos, cient√≠ficos y pedag√≥gicos, as√≠ como la experiencia suficiente para desarrollar los servicios profesionales objeto del presente contrato. Estar registrado ante las autoridades fiscales con el Registro Federal de Contribuyentes (RFC) n√∫mero <span id="c-rfc" class="fill-data"></span>, manifestando bajo protesta de decir verdad conocer y entender las obligaciones fiscales derivadas de su r√©gimen. Que las actividades objeto del presente contrato no representan su √∫nica o principal fuente de ingresos. Se√±alar como su domicilio el ubicado en <span id="c-address" class="fill-data"></span>. Identificarse con identificaci√≥n oficial que obra en su expediente docente n√∫mero y contar con Clave √önica de Registro de Poblaci√≥n (CURP) <span id="c-curp" class="fill-data"></span>. Que reconoce y ratifica las firmas plasmadas digitalmente en el contrato como propias toda vez que es el medio elegido por ambas partes para facilidad y conveniencia.</p>

                <p><strong>III. DECLARAN AMBAS PARTES:</strong> √öNICO.- Que se reconocen mutuamente la personalidad y capacidad legal con la que comparecen, manifestando su consentimiento para obligarse en los t√©rminos de este contrato, cuyo contenido es producto de la buena fe.</p>

                <div class="section-title">C L √Å U S U L A S</div>

                <p><strong>PRIMERA. OBJETO Y VIGENCIA.</strong> ‚ÄúLA INSTITUCI√ìN‚Äù encomienda a ‚ÄúEL PRESTADOR‚Äù, y este se obliga a prestar sus servicios profesionales independientes de forma personal. Los servicios espec√≠ficos, materias y actividades se detallan en el Anexo 1 de este contrato. La vigencia del presente instrumento ser√°: <strong>Del d√≠a 18 de agosto de 2025 al 29 de enero de 2026.</strong> Al t√©rmino de la vigencia, este contrato no se considerar√° renovado t√°cita ni autom√°ticamente bajo ninguna circunstancia. La continuaci√≥n de la prestaci√≥n de servicios requerir√° indispensablemente la celebraci√≥n de un nuevo contrato.</p>

                <p><strong>SEGUNDA. AUSENCIA DE V√çNCULO LABORAL.</strong> Ambas partes reconocen que el presente contrato es de naturaleza estrictamente civil. No establece ni genera una relaci√≥n de trabajo subordinado. En consecuencia, ‚ÄúEL PRESTADOR‚Äù no ser√° considerado trabajador para ning√∫n efecto legal y no le son aplicables las disposiciones de la Ley Federal del Trabajo ni de la Ley del Instituto Mexicano del Seguro Social, por lo que no existe obligaci√≥n rec√≠proca alguna en materia de seguridad social.</p>

                <p><strong>TERCERA. OBLIGACIONES DE ‚ÄúEL PRESTADOR‚Äù.</strong> ‚ÄúEL PRESTADOR‚Äù se obliga a: a) Desempe√±ar los servicios con la m√°s alta diligencia, profesionalismo, √©tica y eficiencia, apeg√°ndose a los planes de estudio, calendarios y reglamentos internos de ‚ÄúLA INSTITUCI√ìN‚Äù. b) Resguardar y supervisar el equipo, materiales y bienes que ‚ÄúLA INSTITUCI√ìN‚Äù le facilite para el desempe√±o de sus servicios, asumiendo la responsabilidad de reponer cualquier p√©rdida o menoscabo que estos sufran por negligencia, dolo o mal uso de su parte. c) Abstenerse de organizar, promover o realizar actos ajenos a los fines acad√©micos de ‚ÄúLA INSTITUCI√ìN‚Äù dentro de sus instalaciones o utilizando su nombre. d) Cumplir cabalmente con las obligaciones que asuma como sinodal, asesor o miembro de cuerpos colegiados.</p>
                
                <p><strong>CUARTA. HONORARIOS Y FORMA DE PAGO.</strong> ‚ÄúLA INSTITUCI√ìN‚Äù se compromete a pagar los honorarios pactados, previa entrega por parte de ‚ÄúEL PRESTADOR‚Äù del Comprobante Fiscal Digital por Internet (CFDI) correspondiente. Dicho pago se realizar√° siguiendo al pie de la letra el procedimiento, fechas y t√©rminos establecidos en el calendario de pagos que ‚ÄúEL PRESTADOR‚Äù manifiesta conocer, y siempre que el comprobante cumpla con todos los requisitos fiscales vigentes. ‚ÄúLA INSTITUCI√ìN‚Äù efectuar√° las retenciones de impuestos que marque la legislaci√≥n aplicable. En el supuesto de que ‚ÄúEL PRESTADOR‚Äù deje su carga acad√©mica o cause baja antes de la finalizaci√≥n del periodo contratado o de los periodos estipulados para la emisi√≥n de facturas, no podr√° solicitar el pago de los honorarios pendientes de manera inmediata. De igual forma, si ‚ÄúEL PRESTADOR‚Äù no genera su CFDI a tiempo, no env√≠a las correcciones solicitadas oportunamente o incumple de cualquier otra manera con el procedimiento de pago, la liquidaci√≥n de los honorarios pendientes quedar√° sujeta al proceso, reprogramaci√≥n y autorizaci√≥n de ‚ÄúLA INSTITUCI√ìN‚Äù.</p>

                <p><strong>QUINTA. AUTONOM√çA CONTRACTUAL</strong> La celebraci√≥n del presente contrato no genera obligaci√≥n alguna para ‚ÄúLA INSTITUCI√ìN‚Äù de mantener o replicar las mismas condiciones (carga de materias/horas, monto de honorarios, etc.) en futuros periodos de contrataci√≥n.</p>

                <p><strong>SEXTA. CONFIDENCIALIDAD.</strong> ‚ÄúEL PRESTADOR‚Äù se obliga a guardar la m√°s estricta confidencialidad respecto a la informaci√≥n interna, documentos, procedimientos, datos personales y/o sensibles a los que tenga acceso por motivo de este contrato. Esta obligaci√≥n subsistir√° a√∫n despu√©s de haber finalizado la vigencia del presente instrumento.</p>

                <p><strong>S√âPTIMA. CAUSAS DE RESCISI√ìN.</strong> ‚ÄúLA INSTITUCI√ìN‚Äù podr√° rescindir administrativamente el presente contrato, sin necesidad de procedimiento judicial y sin responsabilidad alguna para ella, por cualquiera de las siguientes causas imputables a ‚ÄúEL PRESTADOR‚Äù: a) Prestar los servicios de forma inadecuada, deficiente o contraria a lo estipulado en este contrato, los reglamentos o la √©tica profesional. b) Suspender injustificadamente la prestaci√≥n de los servicios. c) Incurrir en un evidente conflicto de intereses, como prestar servicios a instituciones competidoras sin autorizaci√≥n previa y por escrito. d) Presentar documentaci√≥n o informaci√≥n falsa. e) Solicitar o recibir dinero, bienes o favores de los estudiantes a cambio de beneficios acad√©micos. f) Incurrir en faltas de probidad, honradez o llevar a cabo actos que atenten contra el prestigio o la filosof√≠a de ‚ÄúLA INSTITUCI√ìN‚Äù. g) Estar involucrado, se√±alado o investigado por hechos o actos il√≠citos o contrarios a la moral, independientemente de que se acredite o no su responsabilidad legal final en los mismos.</p>

                <p><strong>OCTAVA. TERMINACI√ìN ANTICIPADA.</strong> ‚ÄúLA INSTITUCI√ìN‚Äù podr√° dar por terminado anticipadamente el presente contrato en cualquier momento y sin necesidad de que medie resoluci√≥n judicial o aviso previo, debiendo √∫nicamente cubrir los honorarios que correspondan a los servicios efectivamente prestados y recibidos a su entera satisfacci√≥n. Por su parte, ‚ÄúEL PRESTADOR‚Äù podr√° solicitar la terminaci√≥n anticipada, previo aviso por escrito con al menos siete d√≠as naturales de anticipaci√≥n, reserv√°ndose ‚ÄúLA INSTITUCI√ìN‚Äù el derecho de aceptar dicha terminaci√≥n.</p>

                <p><strong>NOVENA. ACCIONES LEGALES Y JURISDICCI√ìN.</strong> En caso de cualquier controversia judicial iniciada por ‚ÄúEL PRESTADOR‚Äù, ‚ÄúLA INSTITUCI√ìN‚Äù se reserva el derecho de contrademandar por los da√±os y perjuicios que dicha acci√≥n le ocasione. Lo anterior, con independencia de las acciones civiles, penales o de cualquier otra √≠ndole que ‚ÄúLA INSTITUCI√ìN‚Äù pueda iniciar en contra de ‚ÄúEL PRESTADOR‚Äù por incumplimiento del presente contrato. Para la interpretaci√≥n y cumplimiento de este contrato, las partes se someten expresamente a la jurisdicci√≥n de los tribunales competentes de la Ciudad de Puebla, Puebla, renunciando a cualquier fuero que por raz√≥n de sus domicilios presentes o futuros pudiera corresponderles.</p>
                
                <p style="margin-top:15px;">Le√≠do que fue este contrato por las partes y enteradas de su contenido y alcance, firman por duplicado en la ciudad de Puebla, Pue a los 18 d√≠as del mes de Agosto de 2025.</p>

                <div class="signature-grid">
                    <div class="sig-box">
                        <strong>JESUS L√ìPEZ CHARGOY</strong><br>‚ÄúLA INSTITUCI√ìN‚Äù
                    </div>
                    <div class="sig-box">
                        <img class="signature-fill sig-main" src="">
                        <strong id="c-name-sig" style="text-transform: uppercase;"></strong><br>‚ÄúEL PRESTADOR‚Äù
                    </div>
                </div>
                
                <div class="signature-grid" style="margin-top:20px;">
                    <div class="sig-box">
                        <strong>JULIO C√âSAR G√ìMEZ QUINTERO</strong><br>TESTIGO
                    </div>
                    <div class="sig-box">
                        <strong>MIRNA LORENA G√ìMEZ P√âREZ</strong><br>TESTIGO
                    </div>
                </div>
            </div>
        </div>

        <div class="pdf-page-annex">
            
            <div class="section-title">ANEXO 1<br>SERVICIOS PROFESIONALES Y HONORARIOS</div>
            
            <div class="content-body">
                <p>El presente Anexo forma parte integral del Contrato de Prestaci√≥n de Servicios Profesionales Independientes celebrado entre la ‚ÄúINSTITUCI√ìN‚Äù y el ‚ÄúPRESTADOR‚Äù a quienes se hace referencia en dicho instrumento.</p>
                
                <p><strong>1. CARGA ACAD√âMICA</strong></p>
                <table class="contract-table">
                    <tr>
                        <th>Materia Asignada</th>
                        <th>Nivel / Programa</th>
                        <th>Horas por Semana</th>
                        <th>Plantel</th>
                    </tr>
                    <tr>
                        <td>ASIGNACI√ìN M√öLTIPLE</td>
                        <td>LICENCIATURAS</td>
                        <td id="c-hours"></td>
                        <td>DIVERSOS / UDAL</td>
                    </tr>
                </table>
                
                <p><strong>2. ACTIVIDADES ACAD√âMICAS ADICIONALES</strong></p>
                <p>Marcar con una "X" las actividades convenidas: [ ] Asesor√≠a de Tesis [ ] Participaci√≥n en Cuerpos Colegiados [ ] Impartici√≥n de Cursos y/o Talleres</p>
                
                <p><strong>3. CONTRAPRESTACI√ìN ECON√ìMICA (HONORARIOS)</strong></p>
                <p><strong>3.1. Por Hora-Clase (Carga Acad√©mica):</strong> La contraprestaci√≥n que ‚ÄúLA INSTITUCI√ìN‚Äù pagar√° a ‚ÄúEL PRESTADOR‚Äù por los servicios descritos en la tabla de Carga Acad√©mica ser√° de <strong>$<span id="c-rate"></span> M.N.</strong> por cada hora-clase, m√°s el Impuesto al Valor Agregado (IVA) correspondiente. Total Semanal Estimado: <strong>$<span id="c-total"></span> M.N.</strong></p>
                
                <p><strong>3.2. Por Actividades Adicionales:</strong> Monto: $ 0</p>
                
                <p>El pago de todos los honorarios se realizar√° de conformidad con los procedimientos administrativos y t√©rminos establecidos en la Cl√°usula Cuarta del Contrato. Las partes manifiestan su conformidad con los t√©rminos descritos en el presente Anexo, el cual firman en la misma fecha que el Contrato principal.</p>

                <div class="signature-grid" style="margin-top: 40px;">
                    <div class="sig-box">
                        <strong>ING. JES√öS L√ìPEZ CHARGOY</strong><br>‚ÄúLA INSTITUCI√ìN‚Äù
                    </div>
                    <div class="sig-box">
                        <img class="signature-fill sig-main" src="">
                        <strong id="c-name-sig-anexo" style="text-transform: uppercase;"></strong><br>‚ÄúEL PRESTADOR‚Äù
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>

<script>
    // BASE DE DATOS FINAL - DOCENTES Y MATR√çCULAS CORRECTAS
    const rawData = `2567	ABAD DE PAZ DIEGO	24	1800
2511	AGUILA COLIN NANCY	10	560
23539	AGUILAR MONTIEL LUIS JESUS	12	672
23545	AGUIRRE SANTOS ABRIL DANAE	15	975
2656	ALDACO LEZAMA MIRIAM	18	1440
2125	ALMARAZ POLANCO GONZALO	18	1530
5555999	ARROYO VAZQUEZ SERGIO ARMANDO	7	525
2340	AVILA DEL MORAL CARLOS	21	1680
2435	AVILA JIMENEZ PATRICIA	20	1400
1089	AVILA VIEYRA DIONICIO	20	1400
23493	BA√ëUELOS SANTANA ALMA CRISTINA	28	4760
2658	BARRERA QUIROZ ROSA ARELY	16	1600
2679	BARROETA GARDU√ëO CHRYSTIAN	11	880
2628	BERM√öDEZ VICTORIA LIZA ALEJANDRA	30	3000
2422	BERNAL ARGUELLO MARISOL	20	1500
888938	BERNAL QUIROZ MARTHA SILVIA	19	1330
22336	BIVIANO PEREZ EMMA	18	1620
2570	CABALLERO AGUILAR MONTSSERRAT	20	2000
2070	CAMACHO MARTINEZ JUAN ANTONIO	9	540
23579	CAMACHO PEREZ FRANCISCO	23	1380
2634	CAMPOS PADILLA MARISOL	18	1800
2625	CARMONA TREJO GLORIA	7	560
2653	CARRASCO DUE√ëAS MARTHA	16	1600
23399	CASIANO MONTES ZURIHELLY	16	2400
2557	CASTILLERO L√ìPEZ √ÅNGEL	58	5800
2646	CASTILLO QUEVEDO MONICA MARIANA	20	2000
2304	CASTRO JIMENEZ OMAR ARMANDO	7	525
5555998	CASTRO MARTINEZ JORDAN DANIEL	4	300
2657	CHAC√ìN BALTAZAR PAOLA	11	880
23492	CHENA GARCIA ERIKA ROSALBA	21	1260
23608	CITAL√ÅN RODR√çGUEZ JANETH	19	1064
1496	CONTRERAS ARCE PAOLA	14	784
23463	CONTRERAS DELGADILLO RITA	23	3910
5555994	CONTRERAS LEON LUIS ARMANDO	3	210
2684	CORONA FUENTES AGUILAR LILIANA	4	320
2102	CORONA GONZ√ÅLEZ JESSEL	7	392
2638	CORTES AMARO DAFNE MARIANA	20	1600
6571	CORTES VITE ANDREW RAFAEL	20	2000
2410	CUAUTLE XOCHIMITL ERIKA	20	1600
23601	CUELLAR ORTEGA FERNANDO	19	1064
2281	CUESTA SANCHEZ VLADIMIR	13	910
23576	CULEBRO CAMACHO CLAUDIA ESTEFANIA	9	504
23575	CULEBRO CAMACHO GLORIA	10	560
2235	DANIEL ISLAS BEATRIZ	15	1200
2655	DARVICH CAMARA SAMANTHA NATIVIDAD	35	5250
23615	D√ÅVILA ZU√ëIGA LUISA FERNANDA	17	952
23586	DE LA LUZ BRAVO GUADALUPE	20	1120
5555981	DIAZ LOPEZ MARIO MANUEL	9	720
1793	DIAZ NAVA SANDRA	12	1200
5555989	D√çAZ ORTEGA JOS√â MIGUEL	7	490
2572	DIB V√ÅZQUEZ YAMILE	20	2000
2683	DORANTES HERNANDEZ OSCAR SAUL	10	700
2568	DORANTES MARTINEZ EDSON AARON	7	392
23523	ESCAMILLA ANAYA JAIME ISRAEL	12	672
888911	ESCAMILLA CORONA MARCO ANTONIO	3	168
2560	ESTRADA CLARES PAMELA CECIL	18	1800
5555990	FERMIN MEJIA OSCAR	12	780
1272	FERNANDEZ BARRANCO RICARDO	7	490
22306	FLORES DIAZ ADRIANA	10	800
23532	FUENTES MU√ëOZ MAR√çA REYNA	3	210
1540	GALINDO SANCHEZ ROSA MARIA	5	325
2618	GALLARDO CRUZ ARIATNA MERARI	20	2000
2545	GAMBOA ROMERO JORGE LUIS	8	480
2589	GARCIA PINEDA BLANCA SOL	32	4800
2145	GIL VIVEROS CLAUDIA PENELOPE	15	1500
2218	GOMEZ QUINTERO JULIO CESAR	43	4730
23620	GOMEZ ZAMORA ALEJANDRO	23	1840
2678	GONZALEZ AZUARA ARIS	18	1350
2348	GONZALEZ CAMACHO PAMELA	26	2340
23602	GONZ√ÅLEZ L√ìPEZ ISAAC	15	840
2365	GONZALEZ NU√ëEZ ARMANDO	10	650
23581	GONZALEZ SOTO PABLO	18	1008
23585	GONZALEZ TEJEDA AUGUSTO	23	1288
2245	GONZALEZ VARELA JORGE	14	980
1446	GUTIERREZ GAONA CARLOS FELIPE	20	1300
2335	HERNANDEZ CARRERA JOSE ANTONIO	19	1140
2044	HERNANDEZ FLORES AMILCAR HEIMDALL	21	1260
5555988	HERN√ÅNDEZ HERN√ÅNDEZ MAR√çA FERNANDA	19	1520
2629	HERN√ÅNDEZ MERINO AYAX DE JES√öS	20	1400
2308	HERNANDEZ ORTEGA JUAN PABLO	16	960
2527	HERNANDEZ PEREZ DENI BERENISE	16	960
1063	HERN√ÅNDEZ P√âREZ JORGE LUIS	24	3120
2593	HERN√ÅNDEZ RIVEROLL MARTHA ANG√âLICA	11	990
2607	HERNANDEZ SOLIS RAFAEL	15	840
1444	HERNANDEZ TISCARE√ëO MARIA CRISTINA	22	1540
22358	HERNANDEZ VALDIVIA ALMA DELFINA	10	850
2559	HUERTA TOBON MIRIAM	21	1176
23626	IRENE AYLLON HAYDEE AZUCENA	20	1200
23549	JAIME HERNANDEZ SILVIA	19	1710
1027	JIM√âNEZ JIM√âNEZ FRANCISCO	22	2090
2647	JIM√âNEZ MART√çNEZ XIMENA IRAIS	18	1800
2632	JIM√âNEZ MONTIEL OSVALDO	12	960
2620	JIMENEZ RODRIGUEZ LIZETH	17	1360
2631	JU√ÅREZ MIGNON NANCY	8	800
5555992	JULIAN MARQUEZ FELIPE	7	455
2286	LEAL VARGAS ALFONSO	11	1320
2265	LEON GONZALEZ MARIA FERNANDA	19	1140
1081	LICEA HERRERA JOS√â EDUARDO	19	1425
2438	LOPEZ ALCANTARA FELIX	22	1232
2188	LOPEZ GARCIA JORGE	14	980
2311	LOPEZ HERNANDEZ ZAYRA	20	1200
2419	LOPEZ MARTINEZ ANG√âLICA	26	3900
5555993	LOPEZ NIETO MARIO ALBERTO	7	525
23519	LUNA DOMINGUEZ KATIA ELIA	32	4800
2319	LUNA MORAN MARIA DE LOS ANGELES	9	630
5555982	MARIN MARIN ROBERTO GERARDO	21	1470
555972	MARQUEZ MORA ARLETTE	18	1170
1124	MART√çNEZ AVIL√âS MIROSLAVA	13	1040
2323	MARTINEZ MEDINA JOSE MIGUEL	9	720
23531	MART√çNEZ P√âREZ MARIANA	18	1440
1079	MAZ√ì COLLADO LEILA KARINA	20	1500
2256	MEJIA MARTINEZ ESTEFANI	10	600
2578	MEZA CUATIANQUIZ JANET	4	320
2685	MILLAN BUAUN IAN	16	1280
2444	MONTES DANIEL ANDRES	19	1064
1526	MORALES AYALA JOSE LUIS	21	1260
2232	MORALES HERNANDEZ ANGEL	18	1008
23616	MORALES MONTIEL BRENDA DANIELA	16	896
2312	MOR√ÅN MEL√âNDEZ ALEXANDRA	12	672
2555	MU√ëOZ GONZ√ÅLEZ JOSE RAFAEL	13	728
23503	NAVARRO CARRILLO LUZ DEL CARMEN	6	336
2615	NAVARRO MART√çNEZ MARLENE	22	1760
23431	OCOTOXTLE FLORES JOSU√â ALBERTO	15	1050
2598	OLIV√ÅRES HERN√ÅNDEZ RODOLFO CARLOS	23	1288
23622	ORTEGA CUATECO FRANCISCO JAVIER	18	1008
2681	OSORIO TESILLOS LOURDES MARIAN	9	630
2307	PACHECO LIMA FRANCISCO JAVIER	15	1125
2316	PADILLA CANCINO RUTH SKARLETTE	11	770
2583	PALACIOS ORTIZ NASYA	20	2000
23557	PALACIOS VARGAS ADRIANA	16	1600
23535	PAY√ÅN GARC√çA NATALIA	17	1360
2604	PEREZ CARRILLO LUISA FERNANDA	10	700
2563	PEREZ CONCEPCI√ìN ANAYELI	19	1235
23619	PEREZ CONDE MIRLEY	23	1610
2514	PEREZ GARCIA VICTOR FRANCISCO	18	1440
2673	P√âREZ MONTES MONTSERRAT EVELYN	6	480
2616	P√âREZ ORTEGA ANA CAROLINA	12	960
888935	PEREZ ORTEGA JOS√â GIOVANNY	30	2100
2577	P√âREZ PORTILLO ESTELA	11	880
2535	PEREZ RIVERA HILDA MARITZA	20	1600
23386	PEREZ RODRIGUEZ GABRIEL CARMELO	17	1190
2329	PINEDA MENDEZ BLANCA	21	1365
2279	PINEDA ROSSAINZ JOSE CARLOS	12	840
1256	PLAZA MONTA√ëO RICARDO	18	1260
2612	PLIEGO CERD√ÅN CAROLINE ITZEL	12	960
2641	PORTILLO G√ìMEZ CLAUDIA YAMILETH	20	2400
2564	PULIDO HERNANDEZ GUADALUPE MARISOL	10	600
2627	QUESADA RAMIREZ OKSANA ISABEL	3	300
1194	QUIROZ BOLA√ëOS ANNELISE	9	630
1155	RAM√çREZ CUELLAR JULIO CESAR	37	3700
23610	RAMIREZ HERN√ÅNDEZ ALDO	20	1120
23546	RAMIREZ RAMOS MARIANA	20	1400
2553	RAMOS DE GANTE RAUL ENRIQUE	19	1235
2565	RAMOS RAMIREZ URIEL	7	392
2648	RANGEL PACHECO VALERIA	16	1600
2639	REYES CALDERON ERIKA CRISTINA	18	1440
2318	REYES VALADEZ ADRIANA	8	448
2110	RICA√ëO ZETINA LORENA DEL CARMEN	14	910
5555986	RIESTRA ILLESCAS JOSE CARLOS	13	780
2542	RODRIGUEZ BENITEZ VALERIA ALEJANDRA	20	2000
2645	RODR√çGUEZ JU√ÅREZ KAREN ILIANA	18	1440
23534	RODR√çGUEZ L√ìPEZ N√âLYDA CRISTINA	28	4200
2243	RODRIGUEZ MIRON CAROLINA	6	480
2659	RODR√çGUEZ MONTES MIRIAM	18	3060
2643	RODR√çGUEZ SU√ÅREZ EMIR√â BERTHA	4	280
2610	ROJAS PARRA IVAN MOISES	12	840
1280	ROLD√ÅN CANO DIEGO ELADIO	7	770
2429	ROMO CAPULIN CLAUDIA	20	1500
5555991	ROSALES LOPEZ MONTSERRAT	19	1140
1270	ROSAS PEREZ JESUS	11	770
2649	ROSETE MARTINEZ ALMASANDRA	16	1600
23396	SAAVEDRA GONZALEZ WILLIAMS GREGORI	3	300
2606	SANCHEZ CARREON VANESA	20	1200
23617	SANCHEZ CEDILLO EDUARDO	20	1120
23600	SANCHEZ GIL DAFNE SCARLET	19	1520
2257	SANCHEZ HERNANDEZ ISRAEL MAURICIO	14	840
888924	SANCHEZ HERNANDEZ JOSE ARMANDO	11	825
1434	SANCHEZ MU√ëOZ ROSA ISELA	8	520
2449	SANCHEZ VERA GABRIELA	20	2400
23584	SANTIAGO RAMIREZ ATZEL	20	1300
22311	SANTIAGO RAMIREZ MELANIE	9	504
2288	SAYEG MORANCHEL JOSE ARTURO	15	840
1419	SAYEG MORANCHEL VER√ìNICA DEL CARMEN	12	840
23613	SILVA LIMA GABRIEL	6	390
5555975	SOLIS GOMEZ BENJAMIN	16	1280
2315	SORIANO CUELLAR MIRIAM YEZARELA	16	1200
23611	SOSA CASTILLO RAFAEL	8	448
23594	SOSA VAZQUEZ JOSUE FRANCISCO	14	784
2552	SUAREZ CASTILLO RAFAEL ANTONIO	21	1470
2617	SUAREZ ORTIZ BRENDA MAR√çA	15	1200
2600	TEPALCINGO CALVARIO GABRIELA	21	1260
2637	TLILAYATZI V√ÅZQUEZ KARINA	18	1440
2500	TOLENTINO ARANO DIANA	11	1650
23418	TORRES CASTILLO MARIANA	20	1200
2305	URIBE QUIJADA ALEJANDRO	4	280
23522	VALDES CABRERA BLANCA GUADALUPE	21	1365
23429	VALERIO LARA HECTOR	6	480
23443	VARELA HERNANDEZ GABRIELA FERNANDA	15	1200
2328	VARGAS HERNANDEZ HUGO ALFREDO	11	770
5555985	VARGAS HERNANDEZ SAYURI	13	910
2317	VAZQUEZ DONADO JOSE EDUARDO	12	1200
2301	VAZQUEZ FUENTES MARIA GUADALUPE	17	1020
2636	V√ÅZQUEZ JIM√âNEZ ELENA	18	1800
2611	VAZQUEZ MANCILLA BLANCA ALICIA	33	4950
1173	VILLARREAL RU√çZ FRANCISCO	19	1520
2626	VILLEGAS MARTINEZ IRANELI DOLORES	19	1140
2633	VIRUENA POBLANO LESLIE EVELYN	3	300
23588	ZACAULA HERNANDEZ CRISTINA	29	1624
2431	ZAMORA VARELA YESSIKA	13	1170
2390	ZARATE RAMIREZ ALINE	8	800
23609	ZAYAS AVALOS ESTEFANY ANAHI	10	560
1209	ZAYAS PLATAS √ÅNGEL	10	600
23462	ZENTENO ARENAS SARAI NADIEHZDA	19	2850
23595	ZENTENO REYES LUIS FERNANDO	12	720
2543	ZENTENO VERA MERCEDES PATRICIA	12	720`;

    const teachers = rawData.split('\n').map(line => {
        const parts = line.split('\t');
        return {
            matricula: parts[0].trim(),
            name: parts[1].trim(),
            hours: parts[2].trim(),
            rate: parts[3].trim(), 
            total: parts[3].trim()
        };
    });

    let selectedTeacher = null;
    let signaturePad = null;
    let pdfBlob = null;

    window.onload = function() {
        renderList(teachers);
        const canvas = document.getElementById('sig-canvas');
        signaturePad = new SignaturePad(canvas, { 
            penColor: '#0033cc', 
            minWidth: 1,
            maxWidth: 2.5
        });
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();
    };

    function resizeCanvas() {
        const canvas = document.getElementById('sig-canvas');
        if(canvas.offsetWidth > 0) {
            const ratio = Math.max(window.devicePixelRatio || 1, 1);
            canvas.width = canvas.offsetWidth * ratio;
            canvas.height = canvas.offsetHeight * ratio;
            canvas.getContext("2d").scale(ratio, ratio);
            signaturePad.clear(); // Importante: limpiar tras redimensionar para evitar offset
        }
    }

    // Funci√≥n espec√≠fica para el bot√≥n "Limpiar/Corregir"
    function handleClearSig() {
        resizeCanvas(); // Fuerza el rec√°lculo de coordenadas
        signaturePad.clear();
    }

    function renderList(list) {
        const container = document.getElementById('list-container');
        container.innerHTML = '';
        list.forEach(t => {
            const div = document.createElement('div');
            div.className = 'teacher-item';
            div.innerHTML = `<strong>${t.name}</strong>`;
            div.onclick = () => selectTeacher(t);
            container.appendChild(div);
        });
    }

    function filterList() {
        const query = document.getElementById('search-input').value.toUpperCase();
        renderList(teachers.filter(t => t.name.includes(query)));
    }

    function selectTeacher(teacher) {
        selectedTeacher = teacher;
        document.getElementById('lbl-name').innerText = teacher.name;
        document.getElementById('inp-address').value = '';
        document.getElementById('inp-rfc').value = '';
        document.getElementById('inp-curp').value = '';
        document.getElementById('inp-matricula').value = '';
        
        document.getElementById('form-content').style.opacity = '0.5';
        document.getElementById('form-content').style.pointerEvents = 'none';
        
        showView('view-form');
        
        // Timeout para asegurar que el canvas se pinte antes de calcular offset
        setTimeout(resizeCanvas, 100);
    }

    function verifyTeacher() {
        const inputMatricula = document.getElementById('inp-matricula').value.trim();
        
        if (inputMatricula === selectedTeacher.matricula) {
            document.getElementById('form-content').style.display = 'block';
            document.getElementById('form-content').style.opacity = '1';
            document.getElementById('form-content').style.pointerEvents = 'auto';
            alert("‚úÖ Matr√≠cula verificada. Puede proceder a firmar.");
            resizeCanvas(); // Recalcular otra vez por si acaso
        } else {
            alert("‚ùå Matr√≠cula incorrecta.\n\nPor favor comun√≠quese con el Mtro. Julio C√©sar G√≥mez Quintero.");
        }
    }

    function clearPad() { signaturePad.clear(); }

    function showView(id) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        window.scrollTo(0,0);
    }

    async function generateContract() {
        const address = document.getElementById('inp-address').value;
        const rfc = document.getElementById('inp-rfc').value;
        const curp = document.getElementById('inp-curp').value;

        if(!address || !rfc || !curp || signaturePad.isEmpty()) {
            alert("Completa todos los campos y firma.");
            return;
        }

        document.getElementById('loader').style.display = 'flex';

        // 1. Llenar datos
        document.getElementById('c-name').innerText = selectedTeacher.name;
        document.getElementById('c-name-sig').innerText = selectedTeacher.name;
        document.getElementById('c-name-sig-anexo').innerText = selectedTeacher.name;
        document.getElementById('c-address').innerText = address;
        document.getElementById('c-rfc').innerText = rfc;
        document.getElementById('c-curp').innerText = curp;
        document.getElementById('c-hours').innerText = selectedTeacher.hours;
        document.getElementById('c-rate').innerText = "---"; 
        document.getElementById('c-total').innerText = selectedTeacher.total;
        
        // 2. Colocar firmas
        const sigData = signaturePad.toDataURL();
        document.querySelectorAll('.signature-fill').forEach(img => {
            img.src = sigData;
        });

        // 3. Hack de visibilidad
        const wrapper = document.getElementById('contract-wrapper');
        wrapper.classList.add('generating');

        // 4. GENERACI√ìN PDF
        const element = document.getElementById('contract-template');
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF('p', 'pt', 'legal'); 
        
        const pageWidth = doc.internal.pageSize.getWidth(); 
        const srcWidth = 816; 
        const scaleFactor = pageWidth / srcWidth;

        await doc.html(element, {
            callback: function(doc) {
                pdfBlob = doc.output('blob');
                
                const waNumber = "522221158614";
                const msg = `Hola, soy el docente *${selectedTeacher.name}* (ID: ${selectedTeacher.matricula}). Adjunto mi contrato firmado.`;
                document.getElementById('wa-link').href = `https://wa.me/${waNumber}?text=${encodeURIComponent(msg)}`;
                
                downloadPDF();
                
                wrapper.classList.remove('generating');
                document.getElementById('loader').style.display = 'none';
                
                showView('view-success');
            },
            x: 0,
            y: 0,
            html2canvas: { 
                scale: scaleFactor,
                windowWidth: srcWidth,
                useCORS: true 
            },
            width: srcWidth,
            windowWidth: srcWidth
        });
    }

    function downloadPDF() {
        if(pdfBlob) {
            const url = URL.createObjectURL(pdfBlob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Contrato_UDAL_${selectedTeacher.name.replace(/\s+/g,'_')}.pdf`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }
    }
</script>

</body>
</html>